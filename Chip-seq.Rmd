---
title: "Myc Mel Peakset Analysis"
author: "m2407447" 

output: html_document
---
```{r setup, message=FALSE, warning=FALSE}
# Load libraries
library(ChIPseeker)
library(GenomicRanges)

# Read peak files
rep1_file <- "C:/Users/Asus/OneDrive/Desktop/RStudio assessment/Chip-seq/mycmelrep1_peaks.xls"
rep2_file <- "C:/Users/Asus/OneDrive/Desktop/RStudio assessment/Chip-seq/mycmelrep2_peaks.xls"

rep1_peaks <- readPeakFile(rep1_file)
rep2_peaks <- readPeakFile(rep2_file)

# Find common peaks
overlaps <- findOverlaps(rep1_peaks, rep2_peaks)
common_peaks <- rep1_peaks[queryHits(overlaps)]

# View some common peaks
head(common_peaks)


```{r ranking-peaks, message=FALSE, warning=FALSE}
# Sort peaks by fold enrichment in descending order
ranked_peaks <- rep1_peaks[order(rep1_peaks$fold_enrichment, decreasing = TRUE)]

# Select the top 500 peaks
top_500_peaks <- head(ranked_peaks, 500)

# Optional: View the first few rows of the top 500 peaks
head(top_500_peaks)
```




